<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>

<div ng-app="app" ng-controller="appCtrl">
  <div class="p-2">
    <p><%= link_to "Create", task_notes_create_path %></p>
  </div>
  <div class="p-2 d-flex gap-3">
    <label>Priority:</label>
    <div class="form-check form-switch">
      <input class="form-check-input" type="checkbox" id="low" ng-model="low_enabled" ng-change="filter_priority()">
      <label class="form-check-label text-primary" for="low">Low</label>
    </div>
    <div class="form-check form-switch">
      <input class="form-check-input" type="checkbox" id="medium" ng-model="medium_enabled" ng-change="filter_priority()">
      <label class="form-check-label text-warning" for="medium">Medium</label>
    </div>
    <div class="form-check form-switch">
      <input class="form-check-input" type="checkbox" id="high" ng-model="high_enabled" ng-change="filter_priority()">
      <label class="form-check-label text-danger" for="high">High</label>
    </div>
  </div>
  <div class="p-2">
    <div class="mb-2" ng-repeat="t in tasks">
      <div class="task-note-bar" onclick="$(this).next().toggle(500)">
        <div class="ps-1 border bg-light d-flex justify-content-between">
          <div class="flex-grow-1 row  d-flex flex-column flex-md-row">
            <div class="align-content-center col-6">
              <span ng-class="priorities[t.priority]">{{ t.title }}</span>
            </div>
            <div class="align-content-center col-6">
              <span>{{ t.due_date }}</span>
            </div>
          </div>
          <div class="d-flex justify-content-center align-items-center flex-column flex-md-row gap-3">
            <a ng-href="<%= task_notes_edit_path.to_s%>?id={{ t.id }}"><button class="btn btn-primary">Edit</button></a>
            <a ng-href="<%= task_notes_delete_path.to_s%>?id={{ t.id }}"><button class="btn btn-danger">Delete</button></a>
          </div>
        </div>
      </div>
      <div class="bg-info w-100">
        <div class="p-2"> {{ t.description }} </div>
      </div>
    </div>
  </div>
</div>

<script>
    <%= render template: "task_notes/index", formats: [:js] %>
</script>


<%# @task_notes.each do |t| %>
<!--  <p><%#= t.title %></p>-->
<!--  <p><%#= t.description %></p>-->
<!--  <p><%#= t.priority %></p>-->
<!--  <p><%#= t.due_date %></p>-->
<%#= link_to "edit".html_safe, {action: "edit", id: "{{ t.id }}".html_safe } %>
<%#= link_to("delete".html_safe, {action: "delete", id: "{{ t.id }}".html_safe }).html_safe %>
<%# end %>